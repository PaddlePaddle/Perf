-----------  Configuration Arguments -----------
gpus: 0,1,2,3,4,5,6,7
heter_worker_num: None
heter_workers: 
http_port: None
ips: 127.0.0.1
log_dir: log
nproc_per_node: None
run_mode: None
server_num: None
servers: 
training_script: train.py
training_script_args: ['--config', 'benchmark/hrnet.yml', '--iters', '10', '--log_iters', '2', '--batch_size', '8', '--num_workers', '8', '--fp16']
worker_num: None
workers: 
------------------------------------------------
launch train in GPU mode!
launch proc_id:4252 idx:0
launch proc_id:4257 idx:1
launch proc_id:4262 idx:2
launch proc_id:4267 idx:3
launch proc_id:4272 idx:4
launch proc_id:4277 idx:5
launch proc_id:4282 idx:6
launch proc_id:4287 idx:7
2021-05-31 15:51:01 [INFO]	
------------Environment Information-------------
platform: Linux-4.14.0_1-0-0-32-x86_64-with-debian-stretch-sid
Python: 3.7.0 (default, May 26 2019, 06:13:42) [GCC 5.4.0 20160609]
Paddle compiled with cuda: True
NVCC: Cuda compilation tools, release 10.1, V10.1.105
cudnn: 7.6
GPUs used: 8
CUDA_VISIBLE_DEVICES: None
GPU: ['GPU 0: Tesla V100-SXM2-32GB', 'GPU 1: Tesla V100-SXM2-32GB', 'GPU 2: Tesla V100-SXM2-32GB', 'GPU 3: Tesla V100-SXM2-32GB', 'GPU 4: Tesla V100-SXM2-32GB', 'GPU 5: Tesla V100-SXM2-32GB', 'GPU 6: Tesla V100-SXM2-32GB', 'GPU 7: Tesla V100-SXM2-32GB']
GCC: gcc (Ubuntu 5.4.0-6ubuntu1~16.04.11) 5.4.0 20160609
PaddlePaddle: 0.0.0
OpenCV: 4.4.0
------------------------------------------------
2021-05-31 15:51:01 [INFO]	
---------------Config Information---------------
batch_size: 8
iters: 10
learning_rate:
  decay:
    end_lr: 0.0
    power: 0.9
    type: poly
  value: 0.01
loss:
  coef:
  - 1
  types:
  - ignore_index: 255
    type: CrossEntropyLoss
model:
  backbone:
    pretrained: https://bj.bcebos.com/paddleseg/dygraph/hrnet_w18_ssld.tar.gz
    type: HRNet_W18
  backbone_indices:
  - -1
  bias: false
  num_classes: 19
  type: FCN
optimizer:
  type: sgd
  weight_decay: 0.0005
train_dataset:
  dataset_root: data/cityscapes
  mode: train
  transforms:
  - max_scale_factor: 2.0
    min_scale_factor: 0.5
    scale_step_size: 0.25
    type: ResizeStepScaling
  - crop_size:
    - 1024
    - 512
    type: RandomPaddingCrop
  - type: RandomHorizontalFlip
  - type: RandomDistort
  - type: Normalize
  type: Cityscapes
val_dataset:
  dataset_root: data/cityscapes
  mode: val
  transforms:
  - type: Normalize
  type: Cityscapes
------------------------------------------------
W0531 15:51:02.029901  4252 device_context.cc:430] Please NOTE: device: 0, GPU Compute Capability: 7.0, Driver API Version: 11.0, Runtime API Version: 10.1
W0531 15:51:02.029956  4252 device_context.cc:448] device: 0, cuDNN Version: 7.6.
2021-05-31 15:51:06 [INFO]	Loading pretrained model from https://bj.bcebos.com/paddleseg/dygraph/hrnet_w18_ssld.tar.gz
2021-05-31 15:51:12 [INFO]	There are 1525/1525 variables loaded into HRNet.
I0531 15:51:12.537483  4252 nccl_context.cc:74] init nccl context nranks: 8 local rank: 0 gpu id: 0 ring id: 0
I0531 15:51:13.905915  4252 nccl_context.cc:107] init nccl context nranks: 8 local rank: 0 gpu id: 0 ring id: 10
2021-05-31 15:51:14,999-INFO: [topology.py:152:__init__] HybridParallelInfo: rank_id: 0, dp_degree: 8, mp_degree: 1, pp_degree: 1, dp_group: [0, 1, 2, 3, 4, 5, 6, 7], mp_group: [0], pp_group: [0], check/clip group: [0]
2021-05-31 15:51:15 [INFO]	use amp to train
/usr/local/python378-gcc540/lib/python3.7/site-packages/paddle/fluid/dygraph/math_op_patch.py:239: UserWarning: The dtype of left and right variables are not the same, left dtype is paddle.float16, but right dtype is paddle.float32, the right dtype will convert to paddle.float16
  format(lhs_dtype, rhs_dtype, lhs_dtype))
/root/paddlejob/workspace/env_run/PaddleSeg/paddleseg/models/losses/cross_entropy_loss.py:60: DeprecationWarning: [93m
Warning:
API "paddle.nn.functional.loss.softmax_with_cross_entropy" is deprecated since 2.0.0, and will be removed in future versions. Please use "paddle.nn.functional.cross_entropy" instead.
reason: Please notice that behavior of "paddle.nn.functional.softmax_with_cross_entropy" and "paddle.nn.functional.cross_entropy" is different. [0m
  logit, label, ignore_index=self.ignore_index, axis=axis)
2021-05-31 15:51:26 [INFO]	[TRAIN] epoch: 1, iter: 2/10, loss: 2.9130, lr: 0.009095, batch_cost: 5.7468, reader_cost: 2.93844, ips: 1.3921 samples/sec | ETA 00:00:45
2021-05-31 15:51:28 [INFO]	[TRAIN] epoch: 1, iter: 4/10, loss: 2.6289, lr: 0.007254, batch_cost: 0.6361, reader_cost: 0.00017, ips: 12.5771 samples/sec | ETA 00:00:03
2021-05-31 15:51:29 [INFO]	[TRAIN] epoch: 1, iter: 6/10, loss: 1.9580, lr: 0.005359, batch_cost: 0.6469, reader_cost: 0.00015, ips: 12.3659 samples/sec | ETA 00:00:02
2021-05-31 15:51:30 [INFO]	[TRAIN] epoch: 1, iter: 8/10, loss: 1.8813, lr: 0.003384, batch_cost: 0.6646, reader_cost: 0.00019, ips: 12.0380 samples/sec | ETA 00:00:01
2021-05-31 15:51:32 [INFO]	[TRAIN] epoch: 1, iter: 10/10, loss: 1.3829, lr: 0.001259, batch_cost: 0.6631, reader_cost: 0.00015, ips: 12.0652 samples/sec | ETA 00:00:00
<class 'paddle.nn.layer.conv.Conv2D'>'s flops has been counted
Customize Function has been applied to <class 'paddle.nn.layer.norm.SyncBatchNorm'>
Total Flops: -1736046592     Total Params: 9675306
