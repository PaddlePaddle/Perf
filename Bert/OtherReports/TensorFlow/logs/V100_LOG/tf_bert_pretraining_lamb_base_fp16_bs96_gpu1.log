+ batch_size=96
+ num_gpus=1
+ precision=fp16
++ expr 67584 / 96 / 1
+ num_accumulation_steps_phase1=704
+ train_steps=50
+ bert_model=base
+ bash scripts/run_pretraining_lamb.sh 96 64 8 7.5e-4 5e-4 fp16 true 1 2000 200 50 200 704 512 base
Container nvidia build =  13409399
Saving checkpoints to /results/tf_bert_pretraining_lamb_base_fp16_gbs167584_gbs232768_230801035249
Logs written to /results/tf_bert_pretraining_lamb_base_fp16_gbs167584_gbs232768_230801035249/tf_bert_pretraining_lamb_base_fp16_gbs167584_gbs232768.230801035249.log
Container nvidia build =  13409399
XLA activated
2023-08-01 03:52:49.641883: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.11.0
WARNING:tensorflow:Deprecation warnings have been disabled. Set TF_ENABLE_DEPRECATION_WARNINGS=1 to re-enable them.
WARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/horovod-0.19.1-py3.6-linux-x86_64.egg/horovod/tensorflow/__init__.py:152: The name tf.global_variables is deprecated. Please use tf.compat.v1.global_variables instead.

WARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/horovod-0.19.1-py3.6-linux-x86_64.egg/horovod/tensorflow/__init__.py:178: The name tf.get_default_graph is deprecated. Please use tf.compat.v1.get_default_graph instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

W0801 03:52:51.053703 140074314204992 lazy_loader.py:50] 
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /workspace/bert/run_pretraining.py:591: The name tf.enable_resource_variables is deprecated. Please use tf.compat.v1.enable_resource_variables instead.

W0801 03:52:51.615107 140074314204992 module_wrapper.py:139] From /workspace/bert/run_pretraining.py:591: The name tf.enable_resource_variables is deprecated. Please use tf.compat.v1.enable_resource_variables instead.

INFO:tensorflow:Using config: {'_model_dir': '/results/tf_bert_pretraining_lamb_base_fp16_gbs167584_gbs232768_230801035249/phase_1', '_tf_random_seed': None, '_save_summary_steps': 200, '_save_checkpoints_steps': 200, '_save_checkpoints_secs': None, '_session_config': graph_options {
  optimizer_options {
    global_jit_level: ON_1
  }
  rewrite_options {
    memory_optimization: NO_MEM_OPT
  }
}
, '_keep_checkpoint_max': 5, '_keep_checkpoint_every_n_hours': 10000, '_log_step_count_steps': 10000, '_train_distribute': None, '_device_fn': None, '_protocol': None, '_eval_distribute': None, '_experimental_distribute': None, '_experimental_max_worker_delay_secs': None, '_session_creation_timeout_secs': 7200, '_service': None, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f632fc4f438>, '_task_type': 'worker', '_task_id': 0, '_global_id_in_cluster': 0, '_master': '', '_evaluation_master': '', '_is_chief': True, '_num_ps_replicas': 0, '_num_worker_replicas': 1}
I0801 03:52:51.615614 140074314204992 estimator.py:212] Using config: {'_model_dir': '/results/tf_bert_pretraining_lamb_base_fp16_gbs167584_gbs232768_230801035249/phase_1', '_tf_random_seed': None, '_save_summary_steps': 200, '_save_checkpoints_steps': 200, '_save_checkpoints_secs': None, '_session_config': graph_options {
  optimizer_options {
    global_jit_level: ON_1
  }
  rewrite_options {
    memory_optimization: NO_MEM_OPT
  }
}
, '_keep_checkpoint_max': 5, '_keep_checkpoint_every_n_hours': 10000, '_log_step_count_steps': 10000, '_train_distribute': None, '_device_fn': None, '_protocol': None, '_eval_distribute': None, '_experimental_distribute': None, '_experimental_max_worker_delay_secs': None, '_session_creation_timeout_secs': 7200, '_service': None, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f632fc4f438>, '_task_type': 'worker', '_task_id': 0, '_global_id_in_cluster': 0, '_master': '', '_evaluation_master': '', '_is_chief': True, '_num_ps_replicas': 0, '_num_worker_replicas': 1}
WARNING:tensorflow:Estimator's model_fn (<function model_fn_builder.<locals>.model_fn at 0x7f632fbb6048>) includes params argument, but params are not passed to Estimator.
W0801 03:52:51.616142 140074314204992 model_fn.py:630] Estimator's model_fn (<function model_fn_builder.<locals>.model_fn at 0x7f632fbb6048>) includes params argument, but params are not passed to Estimator.
INFO:tensorflow:***** Running training *****
I0801 03:52:51.616501 140074314204992 run_pretraining.py:628] ***** Running training *****
INFO:tensorflow:  Batch size = 96
I0801 03:52:51.616564 140074314204992 run_pretraining.py:629]   Batch size = 96
WARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/tensorflow_core/python/autograph/converters/directives.py:119: The name tf.parse_single_example is deprecated. Please use tf.io.parse_single_example instead.

W0801 03:52:51.707174 140074314204992 module_wrapper.py:139] From /usr/local/lib/python3.6/dist-packages/tensorflow_core/python/autograph/converters/directives.py:119: The name tf.parse_single_example is deprecated. Please use tf.io.parse_single_example instead.

INFO:tensorflow:Calling model_fn.
I0801 03:52:51.807569 140074314204992 estimator.py:1148] Calling model_fn.
INFO:tensorflow:*** Features ***
I0801 03:52:51.807695 140074314204992 run_pretraining.py:260] *** Features ***
INFO:tensorflow:  name = input_ids, shape = (96, 128)
I0801 03:52:51.807784 140074314204992 run_pretraining.py:262]   name = input_ids, shape = (96, 128)
INFO:tensorflow:  name = input_mask, shape = (96, 128)
I0801 03:52:51.807854 140074314204992 run_pretraining.py:262]   name = input_mask, shape = (96, 128)
INFO:tensorflow:  name = masked_lm_ids, shape = (96, 20)
I0801 03:52:51.807930 140074314204992 run_pretraining.py:262]   name = masked_lm_ids, shape = (96, 20)
INFO:tensorflow:  name = masked_lm_positions, shape = (96, 20)
I0801 03:52:51.807993 140074314204992 run_pretraining.py:262]   name = masked_lm_positions, shape = (96, 20)
INFO:tensorflow:  name = masked_lm_weights, shape = (96, 20)
I0801 03:52:51.808054 140074314204992 run_pretraining.py:262]   name = masked_lm_weights, shape = (96, 20)
INFO:tensorflow:  name = next_sentence_labels, shape = (96, 1)
I0801 03:52:51.808112 140074314204992 run_pretraining.py:262]   name = next_sentence_labels, shape = (96, 1)
INFO:tensorflow:  name = segment_ids, shape = (96, 128)
I0801 03:52:51.808171 140074314204992 run_pretraining.py:262]   name = segment_ids, shape = (96, 128)
WARNING:tensorflow:From /workspace/bert/modeling.py:176: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

W0801 03:52:51.808337 140074314204992 module_wrapper.py:139] From /workspace/bert/modeling.py:176: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:From /workspace/bert/modeling.py:427: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

W0801 03:52:51.809313 140074314204992 module_wrapper.py:139] From /workspace/bert/modeling.py:427: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /workspace/bert/run_pretraining.py:298: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

W0801 03:52:53.395768 140074314204992 module_wrapper.py:139] From /workspace/bert/run_pretraining.py:298: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

WARNING:tensorflow:From /workspace/bert/optimization.py:130: The name tf.is_finite is deprecated. Please use tf.math.is_finite instead.

W0801 03:52:56.356138 140074314204992 module_wrapper.py:139] From /workspace/bert/optimization.py:130: The name tf.is_finite is deprecated. Please use tf.math.is_finite instead.

WARNING:tensorflow:From /workspace/bert/optimization.py:142: The name tf.global_norm is deprecated. Please use tf.linalg.global_norm instead.

W0801 03:52:56.579839 140074314204992 module_wrapper.py:139] From /workspace/bert/optimization.py:142: The name tf.global_norm is deprecated. Please use tf.linalg.global_norm instead.

INFO:tensorflow:Done calling model_fn.
I0801 03:53:05.139671 140074314204992 estimator.py:1150] Done calling model_fn.
INFO:tensorflow:Create CheckpointSaverHook.
I0801 03:53:05.140774 140074314204992 basic_session_run_hooks.py:541] Create CheckpointSaverHook.
INFO:tensorflow:Graph was finalized.
I0801 03:53:08.975426 140074314204992 monitored_session.py:240] Graph was finalized.
2023-08-01 03:53:08.986247: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2599995000 Hz
2023-08-01 03:53:08.990208: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x9b8ec80 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2023-08-01 03:53:08.990230: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2023-08-01 03:53:08.992710: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcuda.so.1
2023-08-01 03:53:09.994670: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x8823bb0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2023-08-01 03:53:09.994699: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Tesla V100-SXM2-32GB, Compute Capability 7.0
2023-08-01 03:53:09.994707: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (1): Tesla V100-SXM2-32GB, Compute Capability 7.0
2023-08-01 03:53:09.994712: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (2): Tesla V100-SXM2-32GB, Compute Capability 7.0
2023-08-01 03:53:09.994716: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (3): Tesla V100-SXM2-32GB, Compute Capability 7.0
2023-08-01 03:53:09.994721: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (4): Tesla V100-SXM2-32GB, Compute Capability 7.0
2023-08-01 03:53:09.994725: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (5): Tesla V100-SXM2-32GB, Compute Capability 7.0
2023-08-01 03:53:09.994730: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (6): Tesla V100-SXM2-32GB, Compute Capability 7.0
2023-08-01 03:53:09.994734: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (7): Tesla V100-SXM2-32GB, Compute Capability 7.0
2023-08-01 03:53:10.005973: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1639] Found device 0 with properties: 
name: Tesla V100-SXM2-32GB major: 7 minor: 0 memoryClockRate(GHz): 1.53
pciBusID: 0000:41:00.0
2023-08-01 03:53:10.006445: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1639] Found device 1 with properties: 
name: Tesla V100-SXM2-32GB major: 7 minor: 0 memoryClockRate(GHz): 1.53
pciBusID: 0000:42:00.0
2023-08-01 03:53:10.006914: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1639] Found device 2 with properties: 
name: Tesla V100-SXM2-32GB major: 7 minor: 0 memoryClockRate(GHz): 1.53
pciBusID: 0000:43:00.0
2023-08-01 03:53:10.007349: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1639] Found device 3 with properties: 
name: Tesla V100-SXM2-32GB major: 7 minor: 0 memoryClockRate(GHz): 1.53
pciBusID: 0000:44:00.0
2023-08-01 03:53:10.007789: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1639] Found device 4 with properties: 
name: Tesla V100-SXM2-32GB major: 7 minor: 0 memoryClockRate(GHz): 1.53
pciBusID: 0000:61:00.0
2023-08-01 03:53:10.008225: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1639] Found device 5 with properties: 
name: Tesla V100-SXM2-32GB major: 7 minor: 0 memoryClockRate(GHz): 1.53
pciBusID: 0000:62:00.0
2023-08-01 03:53:10.008664: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1639] Found device 6 with properties: 
name: Tesla V100-SXM2-32GB major: 7 minor: 0 memoryClockRate(GHz): 1.53
pciBusID: 0000:63:00.0
2023-08-01 03:53:10.009099: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1639] Found device 7 with properties: 
name: Tesla V100-SXM2-32GB major: 7 minor: 0 memoryClockRate(GHz): 1.53
pciBusID: 0000:64:00.0
2023-08-01 03:53:10.009132: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.11.0
2023-08-01 03:53:10.012217: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.11
2023-08-01 03:53:10.013549: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2023-08-01 03:53:10.013861: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2023-08-01 03:53:10.016579: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2023-08-01 03:53:10.017153: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.11
2023-08-01 03:53:10.017324: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.8
2023-08-01 03:53:10.024075: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1767] Adding visible gpu devices: 0, 1, 2, 3, 4, 5, 6, 7
2023-08-01 03:53:10.024113: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.11.0
2023-08-01 03:53:12.253486: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1180] Device interconnect StreamExecutor with strength 1 edge matrix:
2023-08-01 03:53:12.253531: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1186]      0 1 2 3 4 5 6 7 
2023-08-01 03:53:12.253543: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1199] 0:   N Y Y Y N N N Y 
2023-08-01 03:53:12.253548: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1199] 1:   Y N Y Y N N Y N 
2023-08-01 03:53:12.253553: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1199] 2:   Y Y N Y N Y N N 
2023-08-01 03:53:12.253558: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1199] 3:   Y Y Y N Y N N N 
2023-08-01 03:53:12.253562: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1199] 4:   N N N Y N Y Y Y 
2023-08-01 03:53:12.253567: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1199] 5:   N N Y N Y N Y Y 
2023-08-01 03:53:12.253571: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1199] 6:   N Y N N Y Y N Y 
2023-08-01 03:53:12.253578: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1199] 7:   Y N N N Y Y Y N 
2023-08-01 03:53:12.257966: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1325] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 30156 MB memory) -> physical GPU (device: 0, name: Tesla V100-SXM2-32GB, pci bus id: 0000:41:00.0, compute capability: 7.0)
2023-08-01 03:53:12.258751: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1325] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 30156 MB memory) -> physical GPU (device: 1, name: Tesla V100-SXM2-32GB, pci bus id: 0000:42:00.0, compute capability: 7.0)
2023-08-01 03:53:12.259424: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1325] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:2 with 30156 MB memory) -> physical GPU (device: 2, name: Tesla V100-SXM2-32GB, pci bus id: 0000:43:00.0, compute capability: 7.0)
2023-08-01 03:53:12.260092: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1325] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:3 with 30156 MB memory) -> physical GPU (device: 3, name: Tesla V100-SXM2-32GB, pci bus id: 0000:44:00.0, compute capability: 7.0)
2023-08-01 03:53:12.260746: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1325] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:4 with 30156 MB memory) -> physical GPU (device: 4, name: Tesla V100-SXM2-32GB, pci bus id: 0000:61:00.0, compute capability: 7.0)
2023-08-01 03:53:12.261392: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1325] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:5 with 30156 MB memory) -> physical GPU (device: 5, name: Tesla V100-SXM2-32GB, pci bus id: 0000:62:00.0, compute capability: 7.0)
2023-08-01 03:53:12.262080: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1325] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:6 with 30156 MB memory) -> physical GPU (device: 6, name: Tesla V100-SXM2-32GB, pci bus id: 0000:63:00.0, compute capability: 7.0)
2023-08-01 03:53:12.262746: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1325] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:7 with 30156 MB memory) -> physical GPU (device: 7, name: Tesla V100-SXM2-32GB, pci bus id: 0000:64:00.0, compute capability: 7.0)
2023-08-01 03:53:15.108130: I tensorflow/core/grappler/optimizers/auto_mixed_precision.cc:1987] Running auto_mixed_precision graph optimizer
2023-08-01 03:53:15.119089: I tensorflow/core/grappler/optimizers/auto_mixed_precision.cc:1343] No whitelist ops found, nothing to do
2023-08-01 03:53:17.227850: W tensorflow/compiler/jit/mark_for_compilation_pass.cc:1648] (One-time warning): Not using XLA:CPU for cluster because envvar TF_XLA_FLAGS=--tf_xla_cpu_global_jit was not set.  If you want XLA:CPU, either set that envvar, or use experimental_jit_scope to enable XLA:CPU.  To confirm that XLA is active, pass --vmodule=xla_compilation_cache=1 (as a proper command-line flag, not via TF_XLA_FLAGS) or set the envvar XLA_FLAGS=--xla_hlo_profile.
2023-08-01 03:53:20.542414: I tensorflow/core/grappler/optimizers/auto_mixed_precision.cc:1987] Running auto_mixed_precision graph optimizer
2023-08-01 03:53:20.548735: I tensorflow/core/grappler/optimizers/auto_mixed_precision.cc:1343] No whitelist ops found, nothing to do
INFO:tensorflow:Running local_init_op.
I0801 03:53:21.191257 140074314204992 session_manager.py:500] Running local_init_op.
2023-08-01 03:53:21.578871: I tensorflow/core/grappler/optimizers/auto_mixed_precision.cc:1987] Running auto_mixed_precision graph optimizer
2023-08-01 03:53:21.579116: I tensorflow/core/grappler/optimizers/auto_mixed_precision.cc:1343] No whitelist ops found, nothing to do
INFO:tensorflow:Done running local_init_op.
I0801 03:53:21.682350 140074314204992 session_manager.py:502] Done running local_init_op.
2023-08-01 03:53:22.199247: I tensorflow/core/grappler/optimizers/auto_mixed_precision.cc:1987] Running auto_mixed_precision graph optimizer
2023-08-01 03:53:22.205589: I tensorflow/core/grappler/optimizers/auto_mixed_precision.cc:1343] No whitelist ops found, nothing to do
2023-08-01 03:53:23.224826: I tensorflow/core/grappler/optimizers/auto_mixed_precision.cc:1987] Running auto_mixed_precision graph optimizer
2023-08-01 03:53:23.225137: I tensorflow/core/grappler/optimizers/auto_mixed_precision.cc:1343] No whitelist ops found, nothing to do
INFO:tensorflow:Saving checkpoints for 0 into /results/tf_bert_pretraining_lamb_base_fp16_gbs167584_gbs232768_230801035249/phase_1/model.ckpt.
I0801 03:53:31.369038 140074314204992 basic_session_run_hooks.py:606] Saving checkpoints for 0 into /results/tf_bert_pretraining_lamb_base_fp16_gbs167584_gbs232768_230801035249/phase_1/model.ckpt.
2023-08-01 03:53:32.112595: I tensorflow/core/grappler/optimizers/auto_mixed_precision.cc:1987] Running auto_mixed_precision graph optimizer
2023-08-01 03:53:32.120658: I tensorflow/core/grappler/optimizers/auto_mixed_precision.cc:1343] No whitelist ops found, nothing to do
2023-08-01 03:53:37.689842: I tensorflow/core/grappler/optimizers/auto_mixed_precision.cc:1987] Running auto_mixed_precision graph optimizer
2023-08-01 03:53:37.690208: I tensorflow/core/grappler/optimizers/auto_mixed_precision.cc:1343] No whitelist ops found, nothing to do
2023-08-01 03:53:37.694308: I tensorflow/core/grappler/optimizers/auto_mixed_precision.cc:1343] No whitelist ops found, nothing to do
2023-08-01 03:53:37.696262: I tensorflow/core/grappler/optimizers/auto_mixed_precision.cc:1343] No whitelist ops found, nothing to do
2023-08-01 03:53:37.699340: I tensorflow/core/grappler/optimizers/auto_mixed_precision.cc:1343] No whitelist ops found, nothing to do
WARNING:tensorflow:From /workspace/bert/run_pretraining.py:147: The name tf.train.get_global_step is deprecated. Please use tf.compat.v1.train.get_global_step instead.

W0801 03:53:37.873744 140074314204992 module_wrapper.py:139] From /workspace/bert/run_pretraining.py:147: The name tf.train.get_global_step is deprecated. Please use tf.compat.v1.train.get_global_step instead.

2023-08-01 03:53:38.332699: I tensorflow/core/grappler/optimizers/auto_mixed_precision.cc:1987] Running auto_mixed_precision graph optimizer
2023-08-01 03:53:38.332991: I tensorflow/core/grappler/optimizers/auto_mixed_precision.cc:1343] No whitelist ops found, nothing to do
2023-08-01 03:53:52.225121: I tensorflow/core/grappler/optimizers/auto_mixed_precision.cc:1987] Running auto_mixed_precision graph optimizer
2023-08-01 03:53:52.354780: I tensorflow/core/grappler/optimizers/auto_mixed_precision.cc:1035] Automatic Mixed Precision Grappler Pass Summary:

Total processable nodes: 24313
Recognized nodes available for conversion: 15663
Total nodes converted: 599
Total FP16 Cast ops used (excluding Const and Variable casts): 102
Whitelisted nodes converted: 300
Blacklisted nodes blocking conversion: 1401
Nodes blocked from conversion by blacklisted nodes: 4428

For more information regarding mixed precision training, including how to make automatic mixed precision aware of a custom op type, please see the documentation available here:
https://docs.nvidia.com/deeplearning/frameworks/tensorflow-user-guide/index.html#tfamp


2023-08-01 03:54:02.212949: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.8
2023-08-01 03:54:02.833933: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.11
2023-08-01 03:54:35.246945: I tensorflow/compiler/jit/xla_compilation_cache.cc:243] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
INFO:tensorflow:loss = 11.135293, step = 0
I0801 03:54:37.046625 140074314204992 basic_session_run_hooks.py:262] loss = 11.135293, step = 0
2023-08-01 03:54:51.048699: I tensorflow/core/grappler/optimizers/auto_mixed_precision.cc:1987] Running auto_mixed_precision graph optimizer
2023-08-01 03:54:51.179060: I tensorflow/core/grappler/optimizers/auto_mixed_precision.cc:1035] Automatic Mixed Precision Grappler Pass Summary:

Total processable nodes: 24313
Recognized nodes available for conversion: 15663
Total nodes converted: 599
Total FP16 Cast ops used (excluding Const and Variable casts): 102
Whitelisted nodes converted: 300
Blacklisted nodes blocking conversion: 1401
Nodes blocked from conversion by blacklisted nodes: 4428

For more information regarding mixed precision training, including how to make automatic mixed precision aware of a custom op type, please see the documentation available here:
https://docs.nvidia.com/deeplearning/frameworks/tensorflow-user-guide/index.html#tfamp


WARNING:tensorflow:It seems that global step (tf.train.get_global_step) has not been increased. Current value (could be stable): 0 vs previous value: 0. You could increase the global step by passing tf.train.get_global_step() to Optimizer.apply_gradients or Optimizer.minimize.
W0801 03:55:32.113358 140074314204992 basic_session_run_hooks.py:724] It seems that global step (tf.train.get_global_step) has not been increased. Current value (could be stable): 0 vs previous value: 0. You could increase the global step by passing tf.train.get_global_step() to Optimizer.apply_gradients or Optimizer.minimize.
WARNING:tensorflow:It seems that global step (tf.train.get_global_step) has not been increased. Current value (could be stable): 0 vs previous value: 0. You could increase the global step by passing tf.train.get_global_step() to Optimizer.apply_gradients or Optimizer.minimize.
W0801 03:55:32.294566 140074314204992 basic_session_run_hooks.py:724] It seems that global step (tf.train.get_global_step) has not been increased. Current value (could be stable): 0 vs previous value: 0. You could increase the global step by passing tf.train.get_global_step() to Optimizer.apply_gradients or Optimizer.minimize.
WARNING:tensorflow:It seems that global step (tf.train.get_global_step) has not been increased. Current value (could be stable): 0 vs previous value: 0. You could increase the global step by passing tf.train.get_global_step() to Optimizer.apply_gradients or Optimizer.minimize.
W0801 03:55:32.472127 140074314204992 basic_session_run_hooks.py:724] It seems that global step (tf.train.get_global_step) has not been increased. Current value (could be stable): 0 vs previous value: 0. You could increase the global step by passing tf.train.get_global_step() to Optimizer.apply_gradients or Optimizer.minimize.
WARNING:tensorflow:It seems that global step (tf.train.get_global_step) has not been increased. Current value (could be stable): 0 vs previous value: 0. You could increase the global step by passing tf.train.get_global_step() to Optimizer.apply_gradients or Optimizer.minimize.
W0801 03:55:32.647814 140074314204992 basic_session_run_hooks.py:724] It seems that global step (tf.train.get_global_step) has not been increased. Current value (could be stable): 0 vs previous value: 0. You could increase the global step by passing tf.train.get_global_step() to Optimizer.apply_gradients or Optimizer.minimize.
WARNING:tensorflow:It seems that global step (tf.train.get_global_step) has not been increased. Current value (could be stable): 0 vs previous value: 0. You could increase the global step by passing tf.train.get_global_step() to Optimizer.apply_gradients or Optimizer.minimize.
W0801 03:55:32.822978 140074314204992 basic_session_run_hooks.py:724] It seems that global step (tf.train.get_global_step) has not been increased. Current value (could be stable): 0 vs previous value: 0. You could increase the global step by passing tf.train.get_global_step() to Optimizer.apply_gradients or Optimizer.minimize.
2023-08-01 04:25:59.674212: I tensorflow/core/grappler/optimizers/auto_mixed_precision.cc:1987] Running auto_mixed_precision graph optimizer
2023-08-01 04:25:59.805772: I tensorflow/core/grappler/optimizers/auto_mixed_precision.cc:1035] Automatic Mixed Precision Grappler Pass Summary:

Total processable nodes: 24313
Recognized nodes available for conversion: 15663
Total nodes converted: 599
Total FP16 Cast ops used (excluding Const and Variable casts): 102
Whitelisted nodes converted: 300
Blacklisted nodes blocking conversion: 1401
Nodes blocked from conversion by blacklisted nodes: 4428

For more information regarding mixed precision training, including how to make automatic mixed precision aware of a custom op type, please see the documentation available here:
https://docs.nvidia.com/deeplearning/frameworks/tensorflow-user-guide/index.html#tfamp


INFO:tensorflow:loss = 11.114401, step = 9 (1926.877 sec)
I0801 04:26:43.923780 140074314204992 basic_session_run_hooks.py:260] loss = 11.114401, step = 9 (1926.877 sec)
INFO:tensorflow:loss = 11.083009, step = 23 (1788.865 sec)
I0801 04:56:32.788878 140074314204992 basic_session_run_hooks.py:260] loss = 11.083009, step = 23 (1788.865 sec)
decayed_learning_rate_at_crossover_point = 7.500000e-04, adjusted_init_lr = 7.500000e-04
Initializing LAMB Optimizer
Skipping time record for  0  due to checkpoint-saving/warmup overhead
DLL 2023-08-01 03:57:41.106103 - Iteration: 1  throughput_train : 278.624 sequences/s mlm_loss : 10.4377  nsp_loss : 0.6962  total_loss : 11.1340  avg_loss_step : 11.1220  learning_rate : 0.0  loss_scaler : 4294967296 
Skipping time record for  0  due to checkpoint-saving/warmup overhead
DLL 2023-08-01 03:59:45.237877 - Iteration: 1  throughput_train : 544.691 sequences/s mlm_loss : 10.4207  nsp_loss : 0.6879  total_loss : 11.1086  avg_loss_step : 11.1230  learning_rate : 0.0  loss_scaler : 2147483648 
Skipping time record for  0  due to checkpoint-saving/warmup overhead
DLL 2023-08-01 04:01:49.393432 - Iteration: 1  throughput_train : 544.600 sequences/s mlm_loss : 10.4533  nsp_loss : 0.6954  total_loss : 11.1487  avg_loss_step : 11.1232  learning_rate : 0.0  loss_scaler : 1073741824 
Skipping time record for  0  due to checkpoint-saving/warmup overhead
DLL 2023-08-01 04:03:53.484241 - Iteration: 1  throughput_train : 544.867 sequences/s mlm_loss : 10.4370  nsp_loss : 0.6943  total_loss : 11.1313  avg_loss_step : 11.1234  learning_rate : 0.0  loss_scaler : 536870912 
Skipping time record for  0  due to checkpoint-saving/warmup overhead
DLL 2023-08-01 04:06:03.182443 - Iteration: 1  throughput_train : 521.310 sequences/s mlm_loss : 10.4074  nsp_loss : 0.7178  total_loss : 11.1252  avg_loss_step : 11.1232  learning_rate : 0.0  loss_scaler : 268435456 
Skipping time record for  1  due to checkpoint-saving/warmup overhead
DLL 2023-08-01 04:08:33.592384 - Iteration: 2  throughput_train : 449.497 sequences/s mlm_loss : 10.4379  nsp_loss : 0.6871  total_loss : 11.1250  avg_loss_step : 11.1227  learning_rate : 0.0  loss_scaler : 134217728 
Skipping time record for  2  due to checkpoint-saving/warmup overhead
DLL 2023-08-01 04:10:39.172208 - Iteration: 3  throughput_train : 538.423 sequences/s mlm_loss : 10.4178  nsp_loss : 0.7023  total_loss : 11.1202  avg_loss_step : 11.1223  learning_rate : 3.75e-07  loss_scaler : 134217728 
Skipping time record for  3  due to checkpoint-saving/warmup overhead
DLL 2023-08-01 04:12:44.887404 - Iteration: 4  throughput_train : 537.828 sequences/s mlm_loss : 10.4213  nsp_loss : 0.6803  total_loss : 11.1015  avg_loss_step : 11.1227  learning_rate : 7.5e-07  loss_scaler : 134217728 
Skipping time record for  4  due to checkpoint-saving/warmup overhead
DLL 2023-08-01 04:14:50.567579 - Iteration: 5  throughput_train : 537.984 sequences/s mlm_loss : 10.4276  nsp_loss : 0.7015  total_loss : 11.1292  avg_loss_step : 11.1214  learning_rate : 1.125e-06  loss_scaler : 134217728 
Skipping time record for  5  due to checkpoint-saving/warmup overhead
DLL 2023-08-01 04:16:56.456185 - Iteration: 6  throughput_train : 537.102 sequences/s mlm_loss : 10.4140  nsp_loss : 0.7025  total_loss : 11.1165  avg_loss_step : 11.1218  learning_rate : 1.5e-06  loss_scaler : 134217728 
DLL 2023-08-01 04:19:02.245543 - Iteration: 7  throughput_train : 537.522 sequences/s mlm_loss : 10.4426  nsp_loss : 0.6847  total_loss : 11.1273  avg_loss_step : 11.1207  learning_rate : 1.8750001e-06  loss_scaler : 134217728 
DLL 2023-08-01 04:21:07.916775 - Iteration: 8  throughput_train : 538.020 sequences/s mlm_loss : 10.4198  nsp_loss : 0.6838  total_loss : 11.1035  avg_loss_step : 11.1198  learning_rate : 2.25e-06  loss_scaler : 134217728 
DLL 2023-08-01 04:23:13.674467 - Iteration: 9  throughput_train : 537.648 sequences/s mlm_loss : 10.4306  nsp_loss : 0.6979  total_loss : 11.1286  avg_loss_step : 11.1208  learning_rate : 2.625e-06  loss_scaler : 134217728 
DLL 2023-08-01 04:25:19.608110 - Iteration: 10  throughput_train : 536.899 sequences/s mlm_loss : 10.4100  nsp_loss : 0.6877  total_loss : 11.0977  avg_loss_step : 11.1184  learning_rate : 3e-06  loss_scaler : 134217728 
DLL 2023-08-01 04:28:23.265116 - Iteration: 11  throughput_train : 368.106 sequences/s mlm_loss : 10.4057  nsp_loss : 0.6891  total_loss : 11.0948  avg_loss_step : 11.1174  learning_rate : 3.3750002e-06  loss_scaler : 134217728 
DLL 2023-08-01 04:30:28.788216 - Iteration: 12  throughput_train : 538.663 sequences/s mlm_loss : 10.4354  nsp_loss : 0.6816  total_loss : 11.1169  avg_loss_step : 11.1173  learning_rate : 3.7500001e-06  loss_scaler : 134217728 
DLL 2023-08-01 04:32:34.303762 - Iteration: 13  throughput_train : 538.685 sequences/s mlm_loss : 10.4202  nsp_loss : 0.6957  total_loss : 11.1159  avg_loss_step : 11.1163  learning_rate : 4.125e-06  loss_scaler : 134217728 
DLL 2023-08-01 04:34:40.048982 - Iteration: 14  throughput_train : 537.708 sequences/s mlm_loss : 10.4444  nsp_loss : 0.6855  total_loss : 11.1299  avg_loss_step : 11.1151  learning_rate : 4.5e-06  loss_scaler : 134217728 
DLL 2023-08-01 04:36:45.740355 - Iteration: 15  throughput_train : 537.933 sequences/s mlm_loss : 10.4392  nsp_loss : 0.6990  total_loss : 11.1382  avg_loss_step : 11.1121  learning_rate : 4.8750003e-06  loss_scaler : 134217728 
DLL 2023-08-01 04:38:51.311119 - Iteration: 16  throughput_train : 538.447 sequences/s mlm_loss : 10.4440  nsp_loss : 0.7013  total_loss : 11.1453  avg_loss_step : 11.1104  learning_rate : 5.25e-06  loss_scaler : 134217728 
DLL 2023-08-01 04:40:57.139912 - Iteration: 17  throughput_train : 537.353 sequences/s mlm_loss : 10.4174  nsp_loss : 0.6963  total_loss : 11.1137  avg_loss_step : 11.1082  learning_rate : 5.625e-06  loss_scaler : 134217728 
DLL 2023-08-01 04:43:03.579104 - Iteration: 18  throughput_train : 534.751 sequences/s mlm_loss : 10.3980  nsp_loss : 0.6833  total_loss : 11.0813  avg_loss_step : 11.1060  learning_rate : 6e-06  loss_scaler : 134217728 
DLL 2023-08-01 04:45:10.183200 - Iteration: 19  throughput_train : 534.052 sequences/s mlm_loss : 10.4200  nsp_loss : 0.7013  total_loss : 11.1212  avg_loss_step : 11.1045  learning_rate : 6.3750003e-06  loss_scaler : 134217728 
DLL 2023-08-01 04:47:16.205641 - Iteration: 20  throughput_train : 536.524 sequences/s mlm_loss : 10.4003  nsp_loss : 0.6922  total_loss : 11.0925  avg_loss_step : 11.1035  learning_rate : 6.7500005e-06  loss_scaler : 134217728 
DLL 2023-08-01 04:49:22.150545 - Iteration: 21  throughput_train : 536.862 sequences/s mlm_loss : 10.4166  nsp_loss : 0.6953  total_loss : 11.1119  avg_loss_step : 11.0989  learning_rate : 7.125e-06  loss_scaler : 134217728 
DLL 2023-08-01 04:51:28.522184 - Iteration: 22  throughput_train : 535.040 sequences/s mlm_loss : 10.4326  nsp_loss : 0.6953  total_loss : 11.1279  avg_loss_step : 11.0982  learning_rate : 7.5000003e-06  loss_scaler : 134217728 
DLL 2023-08-01 04:53:34.934850 - Iteration: 23  throughput_train : 534.861 sequences/s mlm_loss : 10.4049  nsp_loss : 0.6870  total_loss : 11.0919  avg_loss_step : 11.0951  learning_rate : 7.875e-06  loss_scaler : 134217728 
DLL 2023-08-01 04:55:41.019632 - Iteration: 24  throughput_train : 536.260 sequences/s mlm_loss : 10.4091  nsp_loss : 0.6960  total_loss : 11.1051  avg_loss_step : 11.0930  learning_rate : 8.25e-06  loss_scaler : 134217728 
DLL 2023-08-01 04:57:46.978672 - Iteration: 25  throughput_train : 536.796 sequences/s mlm_loss : 10.3946  nsp_loss : 0.6803  total_loss : 11.0749  avg_loss_step : 11.0901  learning_rate : 8.625e-06  loss_scaler : 134217728 
DLL 2023-08-01 04:59:52.632558 - Iteration: 26  throughput_train : 538.093 sequences/s mlm_loss : 10.3918  nsp_loss : 0.7052  total_loss : 11.0971  avg_loss_step : 11.0873  learning_rate : 9e-06  loss_scaler : 134217728 
DLL 2023-08-01 05:01:58.274618 - Iteration: 27  throughput_train : 538.146 sequences/s mlm_loss : 10.3763  nsp_loss : 0.6779  total_loss : 11.0542  avg_loss_step : 11.0840  learning_rate : 9.375e-06  loss_scaler : 134217728 
DLL 2023-08-01 05:04:03.959560 - Iteration: 28  throughput_train : 537.957 sequences/s mlm_loss : 10.3977  nsp_loss : 0.6900  total_loss : 11.0877  avg_loss_step : 11.0811  learning_rate : 9.750001e-06  loss_scaler : 134217728 
DLL 2023-08-01 05:06:09.633467 - Iteration: 29  throughput_train : 538.018 sequences/s mlm_loss : 10.3913  nsp_loss : 0.6998  total_loss : 11.0911  avg_loss_step : 11.0789  learning_rate : 1.0125001e-05  loss_scaler : 134217728 INFO:tensorflow:loss = 10.998341, step = 37 (1787.896 sec)
I0801 05:26:20.684481 140074314204992 basic_session_run_hooks.py:260] loss = 10.998341, step = 37 (1787.896 sec)
INFO:tensorflow:Saving checkpoints for 45 into /results/tf_bert_pretraining_lamb_base_fp16_gbs167584_gbs232768_230801035249/phase_1/model.ckpt.
I0801 05:41:49.618670 140074314204992 basic_session_run_hooks.py:606] Saving checkpoints for 45 into /results/tf_bert_pretraining_lamb_base_fp16_gbs167584_gbs232768_230801035249/phase_1/model.ckpt.
INFO:tensorflow:Loss for final step: 10.973807.
I0801 05:41:53.918470 140074314204992 estimator.py:371] Loss for final step: 10.973807.
INFO:tensorflow:-----------------------------
I0801 05:41:53.919818 140074314204992 run_pretraining.py:647] -----------------------------
INFO:tensorflow:Total Training Time = 6542.30 for Sentences = 3041280
I0801 05:41:53.919901 140074314204992 run_pretraining.py:649] Total Training Time = 6542.30 for Sentences = 3041280
INFO:tensorflow:Total Training Time W/O Overhead = 5090.75 for Sentences = 2365440
I0801 05:41:53.919968 140074314204992 run_pretraining.py:651] Total Training Time W/O Overhead = 5090.75 for Sentences = 2365440
INFO:tensorflow:Throughput Average (sentences/sec) with overhead = 464.86
I0801 05:41:53.920019 140074314204992 run_pretraining.py:652] Throughput Average (sentences/sec) with overhead = 464.86
INFO:tensorflow:Throughput Average (sentences/sec) = 464.65
I0801 05:41:53.920086 140074314204992 run_pretraining.py:653] Throughput Average (sentences/sec) = 464.65
INFO:tensorflow:-----------------------------
I0801 05:41:53.920307 140074314204992 run_pretraining.py:657] -----------------------------
INFO:tensorflow:***** Running evaluation *****
I0801 05:41:53.920379 140074314204992 run_pretraining.py:660] ***** Running evaluation *****
INFO:tensorflow:  Batch size = 8
I0801 05:41:53.920434 140074314204992 run_pretraining.py:661]   Batch size = 8
INFO:tensorflow:Calling model_fn.
I0801 05:41:53.955862 140074314204992 estimator.py:1148] Calling model_fn.
INFO:tensorflow:*** Features ***
I0801 05:41:53.956019 140074314204992 run_pretraining.py:260] *** Features ***
INFO:tensorflow:  name = input_ids, shape = (?, 128)
I0801 05:41:53.956122 140074314204992 run_pretraining.py:262]   name = input_ids, shape = (?, 128)
INFO:tensorflow:  name = input_mask, shape = (?, 128)
I0801 05:41:53.956193 140074314204992 run_pretraining.py:262]   name = input_mask, shape = (?, 128)
INFO:tensorflow:  name = masked_lm_ids, shape = (?, 20)
I0801 05:41:53.956257 140074314204992 run_pretraining.py:262]   name = masked_lm_ids, shape = (?, 20)
INFO:tensorflow:  name = masked_lm_positions, shape = (?, 20)
I0801 05:41:53.956317 140074314204992 run_pretraining.py:262]   name = masked_lm_positions, shape = (?, 20)
INFO:tensorflow:  name = masked_lm_weights, shape = (?, 20)
I0801 05:41:53.956377 140074314204992 run_pretraining.py:262]   name = masked_lm_weights, shape = (?, 20)
INFO:tensorflow:  name = next_sentence_labels, shape = (?, 1)
I0801 05:41:53.956437 140074314204992 run_pretraining.py:262]   name = next_sentence_labels, shape = (?, 1)
INFO:tensorflow:  name = segment_ids, shape = (?, 128)
I0801 05:41:53.956495 140074314204992 run_pretraining.py:262]   name = segment_ids, shape = (?, 128)
WARNING:tensorflow:From /workspace/bert/run_pretraining.py:340: The name tf.metrics.accuracy is deprecated. Please use tf.compat.v1.metrics.accuracy instead.

W0801 05:41:55.946395 140074314204992 module_wrapper.py:139] From /workspace/bert/run_pretraining.py:340: The name tf.metrics.accuracy is deprecated. Please use tf.compat.v1.metrics.accuracy instead.

WARNING:tensorflow:From /workspace/bert/run_pretraining.py:344: The name tf.metrics.mean is deprecated. Please use tf.compat.v1.metrics.mean instead.

W0801 05:41:55.983206 140074314204992 module_wrapper.py:139] From /workspace/bert/run_pretraining.py:344: The name tf.metrics.mean is deprecated. Please use tf.compat.v1.metrics.mean instead.

INFO:tensorflow:Done calling model_fn.
I0801 05:41:56.042135 140074314204992 estimator.py:1150] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2023-08-01T05:41:56Z
I0801 05:41:56.057516 140074314204992 evaluation.py:255] Starting evaluation at 2023-08-01T05:41:56Z
INFO:tensorflow:Graph was finalized.
I0801 05:41:56.330621 140074314204992 monitored_session.py:240] Graph was finalized.
2023-08-01 05:41:56.332274: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1639] Found device 0 with properties: 
name: Tesla V100-SXM2-32GB major: 7 minor: 0 memoryClockRate(GHz): 1.53
pciBusID: 0000:41:00.0
2023-08-01 05:41:56.332765: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1639] Found device 1 with properties: 
name: Tesla V100-SXM2-32GB major: 7 minor: 0 memoryClockRate(GHz): 1.53
pciBusID: 0000:42:00.0
2023-08-01 05:41:56.333226: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1639] Found device 2 with properties: 
name: Tesla V100-SXM2-32GB major: 7 minor: 0 memoryClockRate(GHz): 1.53
pciBusID: 0000:43:00.0
2023-08-01 05:41:56.333664: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1639] Found device 3 with properties: 
name: Tesla V100-SXM2-32GB major: 7 minor: 0 memoryClockRate(GHz): 1.53
pciBusID: 0000:44:00.0
2023-08-01 05:41:56.334115: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1639] Found device 4 with properties: 
name: Tesla V100-SXM2-32GB major: 7 minor: 0 memoryClockRate(GHz): 1.53
pciBusID: 0000:61:00.0
2023-08-01 05:41:56.334552: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1639] Found device 5 with properties: 
name: Tesla V100-SXM2-32GB major: 7 minor: 0 memoryClockRate(GHz): 1.53
pciBusID: 0000:62:00.0
2023-08-01 05:41:56.334991: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1639] Found device 6 with properties: 
name: Tesla V100-SXM2-32GB major: 7 minor: 0 memoryClockRate(GHz): 1.53
pciBusID: 0000:63:00.0
2023-08-01 05:41:56.335425: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1639] Found device 7 with properties: 
name: Tesla V100-SXM2-32GB major: 7 minor: 0 memoryClockRate(GHz): 1.53
pciBusID: 0000:64:00.0
2023-08-01 05:41:56.335471: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.11.0
2023-08-01 05:41:56.335556: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.11
2023-08-01 05:41:56.335578: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2023-08-01 05:41:56.335599: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2023-08-01 05:41:56.335617: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2023-08-01 05:41:56.335637: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.11
2023-08-01 05:41:56.335654: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.8
2023-08-01 05:41:56.342256: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1767] Adding visible gpu devices: 0, 1, 2, 3, 4, 5, 6, 7
2023-08-01 05:41:56.342447: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1180] Device interconnect StreamExecutor with strength 1 edge matrix:
2023-08-01 05:41:56.342461: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1186]      0 1 2 3 4 5 6 7 
2023-08-01 05:41:56.342467: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1199] 0:   N Y Y Y N N N Y 
2023-08-01 05:41:56.342475: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1199] 1:   Y N Y Y N N Y N 
2023-08-01 05:41:56.342480: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1199] 2:   Y Y N Y N Y N N 
2023-08-01 05:41:56.342485: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1199] 3:   Y Y Y N Y N N N 
2023-08-01 05:41:56.342491: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1199] 4:   N N N Y N Y Y Y 
2023-08-01 05:41:56.342495: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1199] 5:   N N Y N Y N Y Y 
2023-08-01 05:41:56.342500: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1199] 6:   N Y N N Y Y N Y 
2023-08-01 05:41:56.342506: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1199] 7:   Y N N N Y Y Y N 
2023-08-01 05:41:56.346746: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1325] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 30156 MB memory) -> physical GPU (device: 0, name: Tesla V100-SXM2-32GB, pci bus id: 0000:41:00.0, compute capability: 7.0)
2023-08-01 05:41:56.347238: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1325] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 30156 MB memory) -> physical GPU (device: 1, name: Tesla V100-SXM2-32GB, pci bus id: 0000:42:00.0, compute capability: 7.0)
2023-08-01 05:41:56.347686: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1325] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:2 with 30156 MB memory) -> physical GPU (device: 2, name: Tesla V100-SXM2-32GB, pci bus id: 0000:43:00.0, compute capability: 7.0)
2023-08-01 05:41:56.348150: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1325] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:3 with 30156 MB memory) -> physical GPU (device: 3, name: Tesla V100-SXM2-32GB, pci bus id: 0000:44:00.0, compute capability: 7.0)
2023-08-01 05:41:56.348595: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1325] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:4 with 30156 MB memory) -> physical GPU (device: 4, name: Tesla V100-SXM2-32GB, pci bus id: 0000:61:00.0, compute capability: 7.0)
2023-08-01 05:41:56.349065: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1325] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:5 with 30156 MB memory) -> physical GPU (device: 5, name: Tesla V100-SXM2-32GB, pci bus id: 0000:62:00.0, compute capability: 7.0)
2023-08-01 05:41:56.349515: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1325] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:6 with 30156 MB memory) -> physical GPU (device: 6, name: Tesla V100-SXM2-32GB, pci bus id: 0000:63:00.0, compute capability: 7.0)
2023-08-01 05:41:56.349963: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1325] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:7 with 30156 MB memory) -> physical GPU (device: 7, name: Tesla V100-SXM2-32GB, pci bus id: 0000:64:00.0, compute capability: 7.0)
INFO:tensorflow:Restoring parameters from /results/tf_bert_pretraining_lamb_base_fp16_gbs167584_gbs232768_230801035249/phase_1/model.ckpt-45
I0801 05:41:56.351032 140074314204992 saver.py:1284] Restoring parameters from /results/tf_bert_pretraining_lamb_base_fp16_gbs167584_gbs232768_230801035249/phase_1/model.ckpt-45
2023-08-01 05:41:56.514641: I tensorflow/core/grappler/optimizers/auto_mixed_precision.cc:1987] Running auto_mixed_precision graph optimizer
2023-08-01 05:41:56.517250: I tensorflow/core/grappler/optimizers/auto_mixed_precision.cc:1343] No whitelist ops found, nothing to do
2023-08-01 05:41:57.016111: I tensorflow/core/grappler/optimizers/auto_mixed_precision.cc:1987] Running auto_mixed_precision graph optimizer
2023-08-01 05:41:57.017754: I tensorflow/core/grappler/optimizers/auto_mixed_precision.cc:1343] No whitelist ops found, nothing to do
INFO:tensorflow:Running local_init_op.
I0801 05:41:57.181739 140074314204992 session_manager.py:500] Running local_init_op.
2023-08-01 05:41:57.222336: I tensorflow/core/grappler/optimizers/auto_mixed_precision.cc:1987] Running auto_mixed_precision graph optimizer
2023-08-01 05:41:57.222680: I tensorflow/core/grappler/optimizers/auto_mixed_precision.cc:1343] No whitelist ops found, nothing to do
INFO:tensorflow:Done running local_init_op.
I0801 05:41:57.484453 140074314204992 session_manager.py:502] Done running local_init_op.
2023-08-01 05:41:57.567394: I tensorflow/core/grappler/optimizers/auto_mixed_precision.cc:1987] Running auto_mixed_precision graph optimizer
2023-08-01 05:41:57.569128: I tensorflow/core/grappler/optimizers/auto_mixed_precision.cc:1343] No whitelist ops found, nothing to do
2023-08-01 05:41:57.781344: I tensorflow/core/grappler/optimizers/auto_mixed_precision.cc:1987] Running auto_mixed_precision graph optimizer
2023-08-01 05:41:57.781645: I tensorflow/core/grappler/optimizers/auto_mixed_precision.cc:1343] No whitelist ops found, nothing to do
2023-08-01 05:41:57.785936: I tensorflow/core/grappler/optimizers/auto_mixed_precision.cc:1343] No whitelist ops found, nothing to do
2023-08-01 05:41:57.788356: I tensorflow/core/grappler/optimizers/auto_mixed_precision.cc:1343] No whitelist ops found, nothing to do
2023-08-01 05:41:58.022589: I tensorflow/core/grappler/optimizers/auto_mixed_precision.cc:1987] Running auto_mixed_precision graph optimizer
2023-08-01 05:41:58.032232: I tensorflow/core/grappler/optimizers/auto_mixed_precision.cc:1035] Automatic Mixed Precision Grappler Pass Summary:

Total processable nodes: 2026
Recognized nodes available for conversion: 1004
Total nodes converted: 276
Total FP16 Cast ops used (excluding Const and Variable casts): 39
Whitelisted nodes converted: 100
Blacklisted nodes blocking conversion: 139
Nodes blocked from conversion by blacklisted nodes: 239

For more information regarding mixed precision training, including how to make automatic mixed precision aware of a custom op type, please see the documentation available here:
https://docs.nvidia.com/deeplearning/frameworks/tensorflow-user-guide/index.html#tfamp


INFO:tensorflow:Evaluation [10/100]
I0801 05:42:03.921270 140074314204992 evaluation.py:167] Evaluation [10/100]
INFO:tensorflow:Evaluation [20/100]
I0801 05:42:04.027157 140074314204992 evaluation.py:167] Evaluation [20/100]
INFO:tensorflow:Evaluation [30/100]
I0801 05:42:04.134010 140074314204992 evaluation.py:167] Evaluation [30/100]
INFO:tensorflow:Evaluation [40/100]
I0801 05:42:04.239412 140074314204992 evaluation.py:167] Evaluation [40/100]
INFO:tensorflow:Evaluation [50/100]
I0801 05:42:04.343198 140074314204992 evaluation.py:167] Evaluation [50/100]
INFO:tensorflow:Evaluation [60/100]
I0801 05:42:04.448787 140074314204992 evaluation.py:167] Evaluation [60/100]
INFO:tensorflow:Evaluation [70/100]
I0801 05:42:04.553055 140074314204992 evaluation.py:167] Evaluation [70/100]
INFO:tensorflow:Evaluation [80/100]
I0801 05:42:04.659252 140074314204992 evaluation.py:167] Evaluation [80/100]
INFO:tensorflow:Evaluation [90/100]
I0801 05:42:04.765006 140074314204992 evaluation.py:167] Evaluation [90/100]
INFO:tensorflow:Evaluation [100/100]
I0801 05:42:04.870743 140074314204992 evaluation.py:167] Evaluation [100/100]
2023-08-01 05:42:04.933454: I tensorflow/core/grappler/optimizers/auto_mixed_precision.cc:1987] Running auto_mixed_precision graph optimizer
2023-08-01 05:42:04.933821: I tensorflow/core/grappler/optimizers/auto_mixed_precision.cc:1343] No whitelist ops found, nothing to do
INFO:tensorflow:Finished evaluation at 2023-08-01-05:42:05
I0801 05:42:05.279395 140074314204992 evaluation.py:275] Finished evaluation at 2023-08-01-05:42:05
INFO:tensorflow:Saving dict for global step 45: global_step = 45, loss = 10.994642, masked_lm_accuracy = 0.00014235888, masked_lm_loss = 10.3056965, next_sentence_accuracy = 0.55625, next_sentence_loss = 0.6886118
I0801 05:42:05.279902 140074314204992 estimator.py:2049] Saving dict for global step 45: global_step = 45, loss = 10.994642, masked_lm_accuracy = 0.00014235888, masked_lm_loss = 10.3056965, next_sentence_accuracy = 0.55625, next_sentence_loss = 0.6886118
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 45: /results/tf_bert_pretraining_lamb_base_fp16_gbs167584_gbs232768_230801035249/phase_1/model.ckpt-45
I0801 05:42:05.593533 140074314204992 estimator.py:2109] Saving 'checkpoint_path' summary for global step 45: /results/tf_bert_pretraining_lamb_base_fp16_gbs167584_gbs232768_230801035249/phase_1/model.ckpt-45
INFO:tensorflow:-----------------------------
I0801 05:42:05.594329 140074314204992 run_pretraining.py:689] -----------------------------
INFO:tensorflow:Total Inference Time = 11.67 for Sentences = 800
I0801 05:42:05.594449 140074314204992 run_pretraining.py:691] Total Inference Time = 11.67 for Sentences = 800
INFO:tensorflow:Total Inference Time W/O Overhead = 1.04 for Sentences = 792
I0801 05:42:05.594512 140074314204992 run_pretraining.py:693] Total Inference Time W/O Overhead = 1.04 for Sentences = 792
INFO:tensorflow:Summary Inference Statistics on EVAL set
I0801 05:42:05.594563 140074314204992 run_pretraining.py:694] Summary Inference Statistics on EVAL set
INFO:tensorflow:Batch size = 8
I0801 05:42:05.594613 140074314204992 run_pretraining.py:695] Batch size = 8
INFO:tensorflow:Sequence Length = 128
I0801 05:42:05.594698 140074314204992 run_pretraining.py:696] Sequence Length = 128
INFO:tensorflow:Precision = fp16
I0801 05:42:05.594749 140074314204992 run_pretraining.py:697] Precision = fp16
INFO:tensorflow:Throughput Average (sentences/sec) = 758.28
I0801 05:42:05.594802 140074314204992 run_pretraining.py:698] Throughput Average (sentences/sec) = 758.28
INFO:tensorflow:-----------------------------
I0801 05:42:05.595016 140074314204992 run_pretraining.py:700] -----------------------------
INFO:tensorflow:***** Eval results *****
I0801 05:42:05.595133 140074314204992 run_pretraining.py:704] ***** Eval results *****
INFO:tensorflow:  global_step = 45
I0801 05:42:05.595193 140074314204992 run_pretraining.py:706]   global_step = 45
INFO:tensorflow:  loss = 10.994642
I0801 05:42:05.595472 140074314204992 run_pretraining.py:706]   loss = 10.994642
INFO:tensorflow:  masked_lm_accuracy = 0.00014235888
I0801 05:42:05.595562 140074314204992 run_pretraining.py:706]   masked_lm_accuracy = 0.00014235888
INFO:tensorflow:  masked_lm_loss = 10.3056965
I0801 05:42:05.595614 140074314204992 run_pretraining.py:706]   masked_lm_loss = 10.3056965
INFO:tensorflow:  next_sentence_accuracy = 0.55625
I0801 05:42:05.595664 140074314204992 run_pretraining.py:706]   next_sentence_accuracy = 0.55625
INFO:tensorflow:  next_sentence_loss = 0.6886118
I0801 05:42:05.595713 140074314204992 run_pretraining.py:706]   next_sentence_loss = 0.6886118

DLL 2023-08-01 05:08:15.562190 - Iteration: 30  throughput_train : 536.917 sequences/s mlm_loss : 10.3840  nsp_loss : 0.7039  total_loss : 11.0879  avg_loss_step : 11.0750  learning_rate : 1.05e-05  loss_scaler : 134217728 
DLL 2023-08-01 05:10:21.188101 - Iteration: 31  throughput_train : 538.211 sequences/s mlm_loss : 10.3558  nsp_loss : 0.6752  total_loss : 11.0310  avg_loss_step : 11.0714  learning_rate : 1.0875e-05  loss_scaler : 134217728 
DLL 2023-08-01 05:12:26.846247 - Iteration: 32  throughput_train : 538.075 sequences/s mlm_loss : 10.3941  nsp_loss : 0.6849  total_loss : 11.0790  avg_loss_step : 11.0692  learning_rate : 1.125e-05  loss_scaler : 134217728 
DLL 2023-08-01 05:14:32.694464 - Iteration: 33  throughput_train : 537.259 sequences/s mlm_loss : 10.3687  nsp_loss : 0.6928  total_loss : 11.0615  avg_loss_step : 11.0644  learning_rate : 1.1625e-05  loss_scaler : 134217728 
DLL 2023-08-01 05:16:38.356684 - Iteration: 34  throughput_train : 538.061 sequences/s mlm_loss : 10.3733  nsp_loss : 0.6947  total_loss : 11.0680  avg_loss_step : 11.0619  learning_rate : 1.2e-05  loss_scaler : 134217728 
DLL 2023-08-01 05:18:44.204147 - Iteration: 35  throughput_train : 537.262 sequences/s mlm_loss : 10.3596  nsp_loss : 0.6712  total_loss : 11.0309  avg_loss_step : 11.0580  learning_rate : 1.2375001e-05  loss_scaler : 134217728 
DLL 2023-08-01 05:20:50.915422 - Iteration: 36  throughput_train : 533.603 sequences/s mlm_loss : 10.3732  nsp_loss : 0.6611  total_loss : 11.0343  avg_loss_step : 11.0532  learning_rate : 1.2750001e-05  loss_scaler : 134217728 
DLL 2023-08-01 05:22:57.352446 - Iteration: 37  throughput_train : 534.766 sequences/s mlm_loss : 10.3739  nsp_loss : 0.6810  total_loss : 11.0549  avg_loss_step : 11.0504  learning_rate : 1.3125001e-05  loss_scaler : 134217728 
DLL 2023-08-01 05:25:03.410594 - Iteration: 38  throughput_train : 536.366 sequences/s mlm_loss : 10.3677  nsp_loss : 0.6949  total_loss : 11.0626  avg_loss_step : 11.0458  learning_rate : 1.3500001e-05  loss_scaler : 134217728 
DLL 2023-08-01 05:27:09.050002 - Iteration: 39  throughput_train : 538.157 sequences/s mlm_loss : 10.3746  nsp_loss : 0.7090  total_loss : 11.0836  avg_loss_step : 11.0424  learning_rate : 1.3875e-05  loss_scaler : 134217728 
DLL 2023-08-01 05:29:14.823214 - Iteration: 40  throughput_train : 537.580 sequences/s mlm_loss : 10.3591  nsp_loss : 0.6822  total_loss : 11.0413  avg_loss_step : 11.0375  learning_rate : 1.425e-05  loss_scaler : 134217728 
DLL 2023-08-01 05:31:20.621885 - Iteration: 41  throughput_train : 537.472 sequences/s mlm_loss : 10.3392  nsp_loss : 0.6820  total_loss : 11.0212  avg_loss_step : 11.0337  learning_rate : 1.4625e-05  loss_scaler : 134217728 
DLL 2023-08-01 05:33:26.278616 - Iteration: 42  throughput_train : 538.077 sequences/s mlm_loss : 10.3608  nsp_loss : 0.6992  total_loss : 11.0600  avg_loss_step : 11.0282  learning_rate : 1.50000005e-05  loss_scaler : 134217728 
DLL 2023-08-01 05:35:32.025993 - Iteration: 43  throughput_train : 537.692 sequences/s mlm_loss : 10.3469  nsp_loss : 0.6601  total_loss : 11.0070  avg_loss_step : 11.0250  learning_rate : 1.5375e-05  loss_scaler : 134217728 
DLL 2023-08-01 05:37:37.776640 - Iteration: 44  throughput_train : 537.683 sequences/s mlm_loss : 10.3571  nsp_loss : 0.6886  total_loss : 11.0456  avg_loss_step : 11.0213  learning_rate : 1.575e-05  loss_scaler : 134217728 
DLL 2023-08-01 05:39:43.728073 - Iteration: 45  throughput_train : 536.822 sequences/s mlm_loss : 10.3474  nsp_loss : 0.6822  total_loss : 11.0296  avg_loss_step : 11.0155  learning_rate : 1.6125001e-05  loss_scaler : 134217728 
DLL 2023-08-01 05:41:49.617798 - Iteration: 46  throughput_train : 537.917 sequences/s mlm_loss : 10.3040  nsp_loss : 0.6699  total_loss : 10.9738  avg_loss_step : 11.0104  learning_rate : 1.65e-05  loss_scaler : 134217728 
DLL 2023-08-01 05:41:53.920137 -  throughput_train : 464.654 sequences/s
DLL 2023-08-01 05:41:53.920256 -  total_loss : 11.0104 
DLL 2023-08-01 05:42:05.594867 -  throughput_val : 758.2846324205155 
