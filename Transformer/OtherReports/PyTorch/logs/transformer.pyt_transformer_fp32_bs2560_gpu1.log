nohup: ignoring input
Namespace(adam_betas='(0.9, 0.997)', adam_eps=1e-09, adaptive_softmax_cutoff=None, amp=False, amp_level='O1', arch='transformer_wmt_en_de_big_t2t', attention_dropout=0.1, beam=4, bpe_codes=None, buffer_size=64, clip_norm=0.0, cpu=False, criterion='label_smoothed_cross_entropy', data='/data/wmt14_en_de_joined_dict', decoder_attention_heads=16, decoder_embed_dim=1024, decoder_embed_path=None, decoder_ffn_embed_dim=4096, decoder_layers=6, decoder_learned_pos=False, decoder_normalize_before=True, device_id=0, distributed_backend='nccl', distributed_init_method=None, distributed_port=-1, distributed_rank=0, distributed_world_size=1, do_sanity_check=False, dropout=0.1, enable_parallel_backward_allred_opt=False, enable_parallel_backward_allred_opt_correctness_check=False, encoder_attention_heads=16, encoder_embed_dim=1024, encoder_embed_path=None, encoder_ffn_embed_dim=4096, encoder_layers=6, encoder_learned_pos=False, encoder_normalize_before=True, fp16=False, fuse_dropout_add=False, fuse_layer_norm=True, fuse_relu_dropout=False, gen_subset='test', keep_interval_updates=-1, label_smoothing=0.1, left_pad_source=True, left_pad_target=False, lenpen=1, local_rank=0, log_interval=500, lr=[0.0006], lr_scheduler='inverse_sqrt', lr_shrink=0.1, max_epoch=1, max_len_a=0, max_len_b=200, max_positions=(1024, 1024), max_sentences=None, max_sentences_valid=None, max_source_positions=1024, max_target_positions=1024, max_tokens=2560, max_update=0, min_len=1, min_loss_scale=0.0001, min_lr=0.0, model_overrides='{}', momentum=0.99, nbest=1, no_beamable_mm=False, no_early_stop=False, no_epoch_checkpoints=False, no_save=False, no_token_positional_embeddings=False, num_shards=1, online_eval=False, optimizer='adam', pad_sequence=1, parallel_backward_allred_opt_threshold=0, path=None, prefix_size=0, print_alignment=False, profile=False, profiler_file=None, profiler_steps=100, quiet=False, raw_text=False, relu_dropout=0.1, remove_bpe=None, replace_unk=None, restore_file='checkpoint_last.pt', sampling=False, sampling_temperature=1, sampling_topk=-1, save_dir='/results/checkpoints', save_interval=1, save_interval_updates=0, save_predictions=False, score_reference=False, seed=1, sentence_avg=False, sentencepiece=False, shard_id=0, share_all_embeddings=True, share_decoder_input_output_embed=False, skip_invalid_size_inputs_valid_test=False, source_lang=None, stat_file='/results/run_log.json', target_bleu=0.0, target_lang=None, test_cased_bleu=False, train_subset='train', unkpen=0, unnormalized=False, update_freq=[1], valid_subset='valid', validate_interval=1, warmup_init_lr=0.0, warmup_updates=4000, weight_decay=0.0)
| [en] dictionary: 33712 types
| [de] dictionary: 33712 types
| /data/wmt14_en_de_joined_dict train 4575637 examples
| /data/wmt14_en_de_joined_dict valid 3000 examples
| /data/wmt14_en_de_joined_dict test 3003 examples
| num. model params: 210808832
| NOTICE: your device may support faster training with --amp
| model transformer_wmt_en_de_big_t2t, criterion LabelSmoothedCrossEntropyCriterion
| training on 1 GPUs
| max tokens per GPU = 2560 and max sentences per GPU = None
| Sentences are being padded to multiples of: 1
| Sentences are being padded to multiples of: 1
| Sentences are being padded to multiples of: 1
Transformer | epoch 0 | step 500 |avg loss 12.152 |avg tokens 2195.818 |tokens/s 8289.358 |walltime 142.634 |
Transformer | epoch 0 | step 1000 |avg loss 10.630 |avg tokens 2202.080 |tokens/s 8228.213 |walltime 276.447 |
Transformer | epoch 0 | step 1500 |avg loss 9.917 |avg tokens 2206.962 |tokens/s 8312.206 |walltime 409.201 |
Transformer | epoch 0 | step 2000 |avg loss 9.383 |avg tokens 2171.184 |tokens/s 8177.711 |walltime 541.951 |
Transformer | epoch 0 | step 2500 |avg loss 8.994 |avg tokens 2185.496 |tokens/s 8263.584 |walltime 674.188 |
Transformer | epoch 0 | step 3000 |avg loss 8.660 |avg tokens 2204.280 |tokens/s 8301.811 |walltime 806.947 |
Transformer | epoch 0 | step 3500 |avg loss 8.411 |avg tokens 2195.928 |tokens/s 8263.810 |walltime 939.811 |
Transformer | epoch 0 | step 4000 |avg loss 8.222 |avg tokens 2206.462 |tokens/s 8299.936 |walltime 1072.731 |
Transformer | epoch 0 | step 4500 |avg loss 8.082 |avg tokens 2182.408 |tokens/s 8276.575 |walltime 1204.574 |
Transformer | epoch 0 | step 5000 |avg loss 7.891 |avg tokens 2192.006 |tokens/s 8297.123 |walltime 1336.668 |
Transformer | epoch 0 | step 5500 |avg loss 7.858 |avg tokens 2150.818 |tokens/s 8207.926 |walltime 1467.689 |
Transformer | epoch 0 | step 6000 |avg loss 7.723 |avg tokens 2184.456 |tokens/s 8273.980 |walltime 1599.697 |
Transformer | epoch 0 | step 6500 |avg loss 7.624 |avg tokens 2188.844 |tokens/s 8280.595 |walltime 1731.864 |
Transformer | epoch 0 | step 7000 |avg loss 7.616 |avg tokens 2169.096 |tokens/s 8213.447 |walltime 1863.909 |
Transformer | epoch 0 | step 7500 |avg loss 7.600 |avg tokens 2200.412 |tokens/s 8328.036 |walltime 1996.018 |
Transformer | epoch 0 | step 8000 |avg loss 7.586 |avg tokens 2179.380 |tokens/s 8275.324 |walltime 2127.697 |
Transformer | epoch 0 | step 8500 |avg loss 7.550 |avg tokens 2201.336 |tokens/s 8306.888 |walltime 2260.198 |
Transformer | epoch 0 | step 9000 |avg loss 7.437 |avg tokens 2186.126 |tokens/s 8228.255 |walltime 2393.040 |
Transformer | epoch 0 | step 9500 |avg loss 7.460 |avg tokens 2194.148 |tokens/s 8258.480 |walltime 2525.883 |
Transformer | epoch 0 | step 10000 |avg loss 7.474 |avg tokens 2192.180 |tokens/s 8247.883 |walltime 2658.776 |
Transformer | epoch 0 | step 10500 |avg loss 7.507 |avg tokens 2149.200 |tokens/s 8153.027 |walltime 2790.580 |
Transformer | epoch 0 | step 11000 |avg loss 7.589 |avg tokens 2169.804 |tokens/s 8250.802 |walltime 2922.070 |
Transformer | epoch 0 | step 11500 |avg loss 7.571 |avg tokens 2169.048 |tokens/s 8224.166 |walltime 3053.941 |
Transformer | epoch 0 | step 12000 |avg loss 7.559 |avg tokens 2196.918 |tokens/s 8321.068 |walltime 3185.950 |
Transformer | epoch 0 | step 12500 |avg loss 7.508 |avg tokens 2182.824 |tokens/s 8205.070 |walltime 3318.967 |
Transformer | epoch 0 | step 13000 |avg loss 7.531 |avg tokens 2203.356 |tokens/s 8294.488 |walltime 3451.788 |
Transformer | epoch 0 | step 13500 |avg loss 7.568 |avg tokens 2217.090 |tokens/s 8380.963 |walltime 3584.057 |
Transformer | epoch 0 | step 14000 |avg loss 7.592 |avg tokens 2166.636 |tokens/s 8187.261 |walltime 3716.374 |
Transformer | epoch 0 | step 14500 |avg loss 7.608 |avg tokens 2170.448 |tokens/s 8227.936 |walltime 3848.270 |
Transformer | epoch 0 | step 15000 |avg loss 7.622 |avg tokens 2201.498 |tokens/s 8309.194 |walltime 3980.743 |
Transformer | epoch 0 | step 15500 |avg loss 7.629 |avg tokens 2192.570 |tokens/s 8152.767 |walltime 4115.211 |
Transformer | epoch 0 | step 16000 |avg loss 7.591 |avg tokens 2207.126 |tokens/s 8229.432 |walltime 4249.311 |
Transformer | epoch 0 | step 16500 |avg loss 7.664 |avg tokens 2186.202 |tokens/s 8209.315 |walltime 4382.464 |
Transformer | epoch 0 | step 17000 |avg loss 7.657 |avg tokens 2189.744 |tokens/s 8197.156 |walltime 4516.032 |
Transformer | epoch 0 | step 17500 |avg loss 7.635 |avg tokens 2169.092 |tokens/s 8114.278 |walltime 4649.691 |
Transformer | epoch 0 | step 18000 |avg loss 7.679 |avg tokens 2165.366 |tokens/s 8174.168 |walltime 4782.142 |
Transformer | epoch 0 | step 18500 |avg loss 7.607 |avg tokens 2196.778 |tokens/s 8187.382 |walltime 4916.299 |
Transformer | epoch 0 | step 19000 |avg loss 7.680 |avg tokens 2184.738 |tokens/s 8244.761 |walltime 5048.791 |
Transformer | epoch 0 | step 19500 |avg loss 7.651 |avg tokens 2166.342 |tokens/s 8219.323 |walltime 5180.575 |
Transformer | epoch 0 | step 20000 |avg loss 7.670 |avg tokens 2161.914 |tokens/s 8225.962 |walltime 5311.983 |
Transformer | epoch 0 | step 20500 |avg loss 7.680 |avg tokens 2166.076 |tokens/s 8209.319 |walltime 5443.911 |
Transformer | epoch 0 | step 21000 |avg loss 7.748 |avg tokens 2191.680 |tokens/s 8306.427 |walltime 5575.837 |
Transformer | epoch 0 | step 21500 |avg loss 7.697 |avg tokens 2194.442 |tokens/s 8309.224 |walltime 5707.886 |
Transformer | epoch 0 | step 22000 |avg loss 7.689 |avg tokens 2204.234 |tokens/s 8307.733 |walltime 5840.547 |
Transformer | epoch 0 | step 22500 |avg loss 7.699 |avg tokens 2172.204 |tokens/s 8269.636 |walltime 5971.884 |
Transformer | epoch 0 | step 23000 |avg loss 7.635 |avg tokens 2172.254 |tokens/s 8226.100 |walltime 6103.918 |
Transformer | epoch 0 | step 23500 |avg loss 7.683 |avg tokens 2178.170 |tokens/s 8304.169 |walltime 6235.067 |
Transformer | epoch 0 | step 24000 |avg loss 7.701 |avg tokens 2163.650 |tokens/s 8237.664 |walltime 6366.394 |
Transformer | epoch 0 | step 24500 |avg loss 7.637 |avg tokens 2169.594 |tokens/s 8213.130 |walltime 6498.475 |
Transformer | epoch 0 | step 25000 |avg loss 7.607 |avg tokens 2197.396 |tokens/s 8290.153 |walltime 6631.005 |
Transformer | epoch 0 | step 25500 |avg loss 7.616 |avg tokens 2205.076 |tokens/s 8286.256 |walltime 6764.061 |
Transformer | epoch 0 | step 26000 |avg loss 7.589 |avg tokens 2215.762 |tokens/s 8329.483 |walltime 6897.069 |
Transformer | epoch 0 | step 26500 |avg loss 7.615 |avg tokens 2203.484 |tokens/s 8313.073 |walltime 7029.600 |
Transformer | epoch 0 | step 27000 |avg loss 7.633 |avg tokens 2177.088 |tokens/s 8257.757 |walltime 7161.421 |
Transformer | epoch 0 | step 27500 |avg loss 7.626 |avg tokens 2186.434 |tokens/s 8254.484 |walltime 7293.860 |
Transformer | epoch 0 | step 28000 |avg loss 7.655 |avg tokens 2194.886 |tokens/s 8279.447 |walltime 7426.410 |
Transformer | epoch 0 | step 28500 |avg loss 7.636 |avg tokens 2194.806 |tokens/s 8327.890 |walltime 7558.184 |
Transformer | epoch 0 | step 29000 |avg loss 7.669 |avg tokens 2164.240 |tokens/s 8250.329 |walltime 7689.345 |
Transformer | epoch 0 | step 29500 |avg loss 7.639 |avg tokens 2199.542 |tokens/s 8324.032 |walltime 7821.465 |
Transformer | epoch 0 | step 30000 |avg loss 7.660 |avg tokens 2167.926 |tokens/s 8250.513 |walltime 7952.847 |
Transformer | epoch 0 | step 30500 |avg loss 7.661 |avg tokens 2195.226 |tokens/s 8314.417 |walltime 8084.860 |
Transformer | epoch 0 | step 31000 |avg loss 7.687 |avg tokens 2180.980 |tokens/s 8291.038 |walltime 8216.386 |
Transformer | epoch 0 | step 31500 |avg loss 7.632 |avg tokens 2180.762 |tokens/s 8259.813 |walltime 8348.397 |
Transformer | epoch 0 | step 32000 |avg loss 7.606 |avg tokens 2193.666 |tokens/s 8318.803 |walltime 8480.246 |
Transformer | epoch 0 | step 32500 |avg loss 7.658 |avg tokens 2165.796 |tokens/s 8270.194 |walltime 8611.186 |
Transformer | epoch 0 | step 33000 |avg loss 7.666 |avg tokens 2182.462 |tokens/s 8276.988 |walltime 8743.025 |
Transformer | epoch 0 | step 33500 |avg loss 7.631 |avg tokens 2200.074 |tokens/s 8322.422 |walltime 8875.203 |
Transformer | epoch 0 | step 34000 |avg loss 7.577 |avg tokens 2211.412 |tokens/s 8341.737 |walltime 9007.754 |
Transformer | epoch 0 | step 34500 |avg loss 7.618 |avg tokens 2174.824 |tokens/s 8299.537 |walltime 9138.775 |
Transformer | epoch 0 | step 35000 |avg loss 7.602 |avg tokens 2174.564 |tokens/s 8271.678 |walltime 9270.221 |
Transformer | epoch 0 | step 35500 |avg loss 7.679 |avg tokens 2162.148 |tokens/s 8243.202 |walltime 9401.369 |
Transformer | epoch 0 | step 36000 |avg loss 7.601 |avg tokens 2165.980 |tokens/s 8197.896 |walltime 9533.474 |
Transformer | epoch 0 | step 36500 |avg loss 7.654 |avg tokens 2203.624 |tokens/s 8294.220 |walltime 9666.315 |
Transformer | epoch 0 | step 37000 |avg loss 7.662 |avg tokens 2163.496 |tokens/s 8162.756 |walltime 9798.838 |
Transformer | epoch 0 | step 37500 |avg loss 7.597 |avg tokens 2172.708 |tokens/s 8160.810 |walltime 9931.956 |
Transformer | epoch 0 | step 38000 |avg loss 7.569 |avg tokens 2200.082 |tokens/s 8258.275 |walltime 10065.161 |
Transformer | epoch 0 | step 38500 |avg loss 7.595 |avg tokens 2195.128 |tokens/s 8272.491 |walltime 10197.837 |
Transformer | epoch 0 | step 39000 |avg loss 7.565 |avg tokens 2222.478 |tokens/s 8259.310 |walltime 10332.381 |
Transformer | epoch 0 | step 39500 |avg loss 7.607 |avg tokens 2195.140 |tokens/s 8306.001 |walltime 10464.523 |
Transformer | epoch 0 | step 40000 |avg loss 7.575 |avg tokens 2185.690 |tokens/s 8245.382 |walltime 10597.063 |
Transformer | epoch 0 | step 40500 |avg loss 7.563 |avg tokens 2207.220 |tokens/s 8236.402 |walltime 10731.055 |
Transformer | epoch 0 | step 41000 |avg loss 7.560 |avg tokens 2187.070 |tokens/s 8160.796 |walltime 10865.054 |
Transformer | epoch 0 | step 41500 |avg loss 7.597 |avg tokens 2163.030 |tokens/s 8155.508 |walltime 10997.665 |
Transformer | epoch 0 | step 42000 |avg loss 7.563 |avg tokens 2152.882 |tokens/s 8121.644 |walltime 11130.205 |
Transformer | epoch 0 | step 42500 |avg loss 7.549 |avg tokens 2216.850 |tokens/s 8258.616 |walltime 11264.419 |
Transformer | epoch 0 | step 43000 |avg loss 7.590 |avg tokens 2175.198 |tokens/s 8150.641 |walltime 11397.857 |
Transformer | epoch 0 | step 43500 |avg loss 7.576 |avg tokens 2187.446 |tokens/s 8150.600 |walltime 11532.046 |
Transformer | epoch 0 | step 44000 |avg loss 7.541 |avg tokens 2193.696 |tokens/s 8226.812 |walltime 11665.372 |
Transformer | epoch 0 | step 44500 |avg loss 7.548 |avg tokens 2167.230 |tokens/s 8153.264 |walltime 11798.278 |
Transformer | epoch 0 | step 45000 |avg loss 7.520 |avg tokens 2162.548 |tokens/s 8161.142 |walltime 11930.768 |
Transformer | epoch 0 | step 45500 |avg loss 7.479 |avg tokens 2178.632 |tokens/s 8151.418 |walltime 12064.403 |
Transformer | epoch 0 | step 46000 |avg loss 7.515 |avg tokens 2166.516 |tokens/s 8150.569 |walltime 12197.309 |
Transformer | epoch 0 | step 46500 |avg loss 7.544 |avg tokens 2177.210 |tokens/s 8173.620 |walltime 12330.494 |
Transformer | epoch 0 | step 47000 |avg loss 7.516 |avg tokens 2159.966 |tokens/s 8112.725 |walltime 12463.616 |
Transformer | epoch 0 | step 47500 |avg loss 7.445 |avg tokens 2183.310 |tokens/s 8201.379 |walltime 12596.723 |
Transformer | epoch 0 | step 48000 |avg loss 7.485 |avg tokens 2207.598 |tokens/s 8241.243 |walltime 12730.659 |
Transformer | epoch 0 | step 48500 |avg loss 7.527 |avg tokens 2174.254 |tokens/s 8205.941 |walltime 12863.139 |
Transformer | epoch 0 | step 49000 |avg loss 7.517 |avg tokens 2180.624 |tokens/s 8209.757 |walltime 12995.946 |
Transformer | epoch 0 | step 49500 |avg loss 7.535 |avg tokens 2156.342 |tokens/s 8178.281 |walltime 13127.779 |
Transformer | epoch 0 | step 50000 |avg loss 7.476 |avg tokens 2199.442 |tokens/s 8208.834 |walltime 13261.747 |
Transformer | epoch 0 | step 50500 |avg loss 7.512 |avg tokens 2164.196 |tokens/s 8200.566 |walltime 13393.702 |
Transformer | epoch 0 | step 51000 |avg loss 7.519 |avg tokens 2210.832 |tokens/s 8300.968 |walltime 13526.869 |
Transformer | epoch 0 | step 51500 |avg loss 7.526 |avg tokens 2170.272 |tokens/s 8154.514 |walltime 13659.940 |
Transformer | epoch 0 | step 52000 |avg loss 7.566 |avg tokens 2144.520 |tokens/s 8236.081 |walltime 13790.131 |
Transformer | epoch 0 | step 52500 |avg loss 7.477 |avg tokens 2173.838 |tokens/s 8202.748 |walltime 13922.638 |
Transformer | epoch 0 | step 53000 |avg loss 7.471 |avg tokens 2186.586 |tokens/s 8320.763 |walltime 14054.031 |
Transformer | epoch 0 | step 53500 |avg loss 7.493 |avg tokens 2162.470 |tokens/s 8276.680 |walltime 14184.667 |
Transformer | epoch 0 | step 54000 |avg loss 7.511 |avg tokens 2185.144 |tokens/s 8339.763 |walltime 14315.675 |
Transformer | epoch 0 | step 54500 |avg loss 7.515 |avg tokens 2181.010 |tokens/s 8323.035 |walltime 14446.698 |
Transformer | epoch 0 | step 55000 |avg loss 7.471 |avg tokens 2164.734 |tokens/s 8169.513 |walltime 14579.186 |
Transformer | epoch 0 | step 55500 |avg loss 7.462 |avg tokens 2175.078 |tokens/s 8194.102 |walltime 14711.908 |
Transformer | epoch 0 | step 56000 |avg loss 7.465 |avg tokens 2165.984 |tokens/s 8260.911 |walltime 14843.007 |
Transformer | epoch 0 | step 56500 |avg loss 7.467 |avg tokens 2200.316 |tokens/s 8346.269 |walltime 14974.821 |
Transformer | epoch 0 | step 57000 |avg loss 7.519 |avg tokens 2158.848 |tokens/s 8250.587 |walltime 15105.651 |
Transformer | epoch 0 | step 57500 |avg loss 7.450 |avg tokens 2168.044 |tokens/s 8260.896 |walltime 15236.874 |
Transformer | epoch 0 | step 58000 |avg loss 7.454 |avg tokens 2158.620 |tokens/s 8225.355 |walltime 15368.092 |
Transformer | epoch 0 | step 58500 |avg loss 7.475 |avg tokens 2188.858 |tokens/s 8303.732 |walltime 15499.891 |
Transformer | epoch 0 | step 59000 |avg loss 7.450 |avg tokens 2168.490 |tokens/s 8143.818 |walltime 15633.029 |
Transformer | epoch 0 | step 59500 |avg loss 7.468 |avg tokens 2155.120 |tokens/s 8118.629 |walltime 15765.755 |
Transformer | epoch 0 | step 60000 |avg loss 7.389 |avg tokens 2186.216 |tokens/s 8323.939 |walltime 15897.077 |
Transformer | epoch 0 | step 60500 |avg loss 7.435 |avg tokens 2178.198 |tokens/s 8281.456 |walltime 16028.587 |
Transformer | epoch 0 | step 61000 |avg loss 7.452 |avg tokens 2154.616 |tokens/s 8227.945 |walltime 16159.520 |
Transformer | epoch 0 | step 61500 |avg loss 7.475 |avg tokens 2174.858 |tokens/s 8334.523 |walltime 16289.993 |
Transformer | epoch 0 | step 62000 |avg loss 7.472 |avg tokens 2162.480 |tokens/s 8133.308 |walltime 16422.933 |
Transformer | epoch 0 | step 62500 |avg loss 7.455 |avg tokens 2164.270 |tokens/s 8110.761 |walltime 16556.352 |
Transformer | epoch 0 | step 63000 |avg loss 7.449 |avg tokens 2176.958 |tokens/s 8196.144 |walltime 16689.156 |
Transformer | epoch 0 | step 63500 |avg loss 7.462 |avg tokens 2174.884 |tokens/s 8277.476 |walltime 16820.530 |
Transformer | epoch 0 | step 64000 |avg loss 7.412 |avg tokens 2208.194 |tokens/s 8305.859 |walltime 16953.460 |
Transformer | epoch 0 | step 64500 |avg loss 7.463 |avg tokens 2184.822 |tokens/s 8153.564 |walltime 17087.439 |
Transformer | epoch 0 | step 65000 |avg loss 7.402 |avg tokens 2204.512 |tokens/s 8204.052 |walltime 17221.794 |
Epoch time: 17264.9287276268
Transformer | epoch 0 | step 65198 |avg loss 7.538 |avg tokens 2144.318 |tokens/s 7983.551 |walltime 17274.975 |
Validation loss on subset valid: 7.380476935892614
/workspace/translation/fairseq/sequence_generator.py:376: UserWarning: Integer division of tensors using div or / is deprecated, and in a future release div will perform true division as in Python 3. Use true_divide or floor_divide (// in Python) instead. (Triggered internally at  ../aten/src/ATen/native/BinaryOps.cpp:66.)
  torch.div(cand_indices, self.vocab_size, out=cand_beams)
| Translated 3000 sentences (124565 tokens) in 75.7s (39.64 sentences/s, 1645.87 tokens/s)
| Eval completed in: 98.04s | UNCASED BLEU 1.45
| done training in 17378.6 seconds
Transformer | epoch 0 | step RUN |avg loss 7.380 |walltime 17388.917 |
